<?xml version="1.0"?>
<robot xmlns:xacro="http://www.ros.org/wiki/xacro" name="four_dof_arm">

  <material name="grey"><color rgba="0.2 0.2 0.2 1.0"/></material>
  <material name="orange"><color rgba="1.0 0.4235 0.0392 1.0"/></material>
  <material name="black"><color rgba="0.0 0.0 0.0 1.0"/></material>
  <material name="white"><color rgba="1.0 1.0 1.0 1.0"/></material>

  <!-- Base -->
  <link name="base_link">
    <visual>
      <origin xyz="0 0 0.05" rpy="0 0 0"/>
      <geometry><cylinder radius="0.15" length="0.1"/></geometry>
      <material name="black"/>
    </visual>
    <visual>
      <origin xyz="0 0 0.025" rpy="0 0 0"/>
      <geometry><box size="0.3 0.3 0.05"/></geometry>
      <material name="grey"/>
    </visual>
    <collision><geometry><box size="0.3 0.3 0.1"/></geometry></collision>
    <inertial><mass value="5.0"/><inertia ixx="0.042" iyy="0.042" izz="0.038" ixy="0" ixz="0" iyz="0"/></inertial>
  </link>

  <!-- Link1 - Visual geometry offset so it starts at the joint -->
  <link name="link1">
    <visual>
      <geometry><cylinder length="0.4" radius="0.04"/></geometry>
      <!-- Offset the cylinder so its BASE is at the joint, not center -->
      <origin xyz="0 0 0.2" rpy="0 0 0"/>
      <material name="orange"/>
    </visual>
    <visual>
       <!-- Joint 1 Hub -->
       <geometry><cylinder length="0.1" radius="0.06"/></geometry>
       <origin xyz="0 0 0" rpy="0 0 0"/>
       <material name="black"/>
    </visual>
    <collision>
      <geometry><cylinder length="0.35" radius="0.045"/></geometry>
      <origin xyz="0 0 0.175" rpy="0 0 0"/>
    </collision>
    <inertial>
      <mass value="1.0"/>
      <inertia ixx="0.0133" iyy="0.0133" izz="0.0008" ixy="0" ixz="0" iyz="0"/>
    </inertial>
  </link>

  <joint name="joint1" type="revolute">
    <parent link="base_link"/>
    <child link="link1"/>
    <!-- At top surface of base (z = 0.05) -->
    <origin xyz="0 0 0.05" rpy="0 0 0"/>
    <axis xyz="0 0 1"/>
    <limit lower="-3.14" upper="3.14" effort="5.0" velocity="1.0"/>
  </joint>

  <!-- Link2 - Visual geometry offset -->
  <link name="link2">
    <visual>
      <geometry><cylinder length="0.3" radius="0.035"/></geometry>
      <!-- Offset so base is at joint -->
      <origin xyz="0 0 0.15" rpy="0 0 0"/>
      <material name="orange"/>
    </visual>
    <visual>
       <!-- Joint 2 Hub (Axis Y) -->
       <geometry><cylinder length="0.08" radius="0.05"/></geometry>
       <origin xyz="0 0 0" rpy="1.5708 0 0"/>
       <material name="black"/>
    </visual>
    <collision>
      <geometry><cylinder length="0.25" radius="0.04"/></geometry>
      <origin xyz="0 0 0.125" rpy="0 0 0"/>
    </collision>
    <inertial>
      <mass value="0.8"/>
      <inertia ixx="0.0067" iyy="0.0067" izz="0.0004" ixy="0" ixz="0" iyz="0"/>
    </inertial>
  </link>

  <joint name="joint2" type="revolute">
    <parent link="link1"/>
    <child link="link2"/>
    <!-- At the END of link1 (0.4 from joint1) -->
    <origin xyz="0 0 0.4" rpy="0 0 0"/>
    <axis xyz="0 1 0"/>
    <limit lower="-1.57" upper="1.57" effort="5.0" velocity="1.0"/>
  </joint>

  <!-- Link3 - Visual geometry offset -->
  <link name="link3">
    <visual>
      <geometry><cylinder length="0.25" radius="0.03"/></geometry>
      <origin xyz="0 0 0.125" rpy="0 0 0"/>
      <material name="orange"/>
    </visual>
    <visual>
       <!-- Joint 3 Hub (Axis Y) -->
       <geometry><cylinder length="0.07" radius="0.045"/></geometry>
       <origin xyz="0 0 0" rpy="1.5708 0 0"/>
       <material name="black"/>
    </visual>
    <collision>
      <geometry><cylinder length="0.2" radius="0.035"/></geometry>
      <origin xyz="0 0 0.1" rpy="0 0 0"/>
    </collision>
    <inertial>
      <mass value="0.5"/>
      <inertia ixx="0.0042" iyy="0.0042" izz="0.0002" ixy="0" ixz="0" iyz="0"/>
    </inertial>
  </link>

  <joint name="joint3" type="revolute">
    <parent link="link2"/>
    <child link="link3"/>
    <!-- At the END of link2 (0.3 from joint2) -->
    <origin xyz="0 0 0.3" rpy="0 0 0"/>
    <axis xyz="0 1 0"/>
    <limit lower="-1.57" upper="1.57" effort="3.0" velocity="1.0"/>
  </joint>

  <!-- Link4 - Visual geometry offset -->
  <link name="link4">
    <visual>
      <geometry><cylinder length="0.2" radius="0.025"/></geometry>
      <origin xyz="0 0 0.1" rpy="0 0 0"/>
      <material name="orange"/>
    </visual>
    <visual>
       <!-- Joint 4 Hub (Axis Y) -->
       <geometry><cylinder length="0.06" radius="0.04"/></geometry>
       <origin xyz="0 0 0" rpy="1.5708 0 0"/>
       <material name="black"/>
    </visual>
    <collision>
      <geometry><cylinder length="0.15" radius="0.03"/></geometry>
      <origin xyz="0 0 0.075" rpy="0 0 0"/>
    </collision>
    <inertial>
      <mass value="0.3"/>
      <inertia ixx="0.0025" iyy="0.0025" izz="0.0001" ixy="0" ixz="0" iyz="0"/>
    </inertial>
  </link>

  <joint name="joint4" type="revolute">
    <parent link="link3"/>
    <child link="link4"/>
    <!-- At the END of link3 (0.25 from joint3) -->
    <origin xyz="0 0 0.25" rpy="0 0 0"/>
    <axis xyz="0 1 0"/>
    <limit lower="-1.57" upper="1.57" effort="3.0" velocity="1.0"/>
  </joint>

  <!-- End effector -->
  <link name="ee_link">
    <visual>
      <!-- Gripper Base -->
      <geometry><box size="0.05 0.1 0.02"/></geometry>
      <origin xyz="0 0 0.0" rpy="0 0 0"/>
      <material name="black"/>
    </visual>
    <visual>
      <!-- Finger 1 -->
      <geometry><box size="0.02 0.02 0.08"/></geometry>
      <origin xyz="0 0.03 0.04" rpy="0 0 0"/>
      <material name="grey"/>
    </visual>
    <visual>
      <!-- Finger 2 -->
      <geometry><box size="0.02 0.02 0.08"/></geometry>
      <origin xyz="0 -0.03 0.04" rpy="0 0 0"/>
      <material name="grey"/>
    </visual>
    <collision><geometry><sphere radius="0.025"/></geometry></collision>
    <inertial><mass value="0.1"/><inertia ixx="0.000009" iyy="0.000009" izz="0.000009" ixy="0" ixz="0" iyz="0"/></inertial>
  </link>

  <joint name="ee_fixed" type="fixed">
    <parent link="link4"/>
    <child link="ee_link"/>
    <!-- At the END of link4 (0.2 from joint4) -->
    <origin xyz="0 0 0.2" rpy="0 0 0"/>
  </joint>

</robot>
